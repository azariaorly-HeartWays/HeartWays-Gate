<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#eaf2ff" />
<title>HeartWays — פתיחה מותאמת</title>
<style>
:root{
  --bg-from:#eaf2ff; --bg-to:#f9fbff;
  --text:#173b6f; --text-soft:#2b5a92; --accent:#2e6bff;
  --glass: rgba(255,255,255,.68); --shadow:0 10px 30px rgba(46,107,255,.18);
  --star:#ffe9b0; --star2:#fff6df;
  --blob1:#7cc8ff; --blob2:#ffd4e3; --blob3:#d7c6ff;
}
*{box-sizing:border-box} html,body{height:100%}
body{
  margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans";
  background:linear-gradient(180deg,var(--bg-from),var(--bg-to));
  color:var(--text); display:flex; align-items:center; justify-content:center; padding:20px; overflow-x:hidden;
}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* רקע נוזלי + אותיות בתנועה */
.blobs{ position:fixed; inset:-20vmax -10vmax auto auto; width:120vmax; height:120vmax; z-index:0; pointer-events:none; filter: blur(40px); }
.blob{ position:absolute; border-radius:40%; opacity:.35; mix-blend-mode:multiply; transform:translateZ(0); animation:floaty 16s ease-in-out infinite; }
.blob.b1{ background:var(--blob1); width:36vmax;height:36vmax; left:10%;top:0; animation-duration:18s }
.blob.b2{ background:var(--blob2); width:28vmax;height:28vmax; right:10%;top:20%; animation-duration:20s }
.blob.b3{ background:var(--blob3); width:32vmax;height:32vmax; left:35%;top:35%; animation-duration:22s }
@keyframes floaty{0%,100%{transform:translateY(0) rotate(0)}50%{transform:translateY(-20px) rotate(8deg)}}

.letters{
  position:fixed; inset:0; z-index:0; pointer-events:none; display:grid; place-items:center;
  font-size:18vmin; font-weight:900; letter-spacing:.7vmin; opacity:.07; color:#0f2233; text-align:center; line-height:1.1;
  text-shadow:0 1px 0 rgba(255,255,255,.12), 0 8px 16px rgba(15,34,51,.28), 0 18px 30px rgba(15,34,51,.18);
  filter: blur(.2px);
  animation: drift 28s linear infinite;
}
@keyframes drift{0%{transform:translateY(0)}50%{transform:translateY(-10px)}100%{transform:translateY(0)}}

/* קלף מרכזי */
.wrap{ position:relative; z-index:1; width:min(94vw,920px) }
.card{
  background:var(--glass); -webkit-backdrop-filter: blur(14px) saturate(140%); backdrop-filter: blur(14px) saturate(140%);
  border-radius:22px; padding:18px; box-shadow:var(--shadow); overflow:hidden;
}
.card::after{
  content:""; position:absolute; inset:-40% -60%; border-radius:40%;
  background: conic-gradient(from 0deg, transparent 0 70%, rgba(255,255,255,.18) 80%, transparent 88%);
  animation: sheen 14s linear infinite; mix-blend-mode: soft-light; pointer-events:none;
}
@keyframes sheen{ to{ transform: rotate(360deg) } }

/* טופבר+סטטוס */
.topbar{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
.titlebox{ text-align:center; flex:1 }
h1{margin:0;color:var(--text); font-size:1.55rem}
.sub{margin:0;color:var(--text-soft); font-weight:700}
.status{ display:flex; align-items:center; gap:.45rem; justify-content:center; color:#1c3f74; font-weight:800; margin:8px 0 2px }
.chip{ display:inline-flex; align-items:center; gap:.35rem; padding:.35rem .65rem; border-radius:999px;
  background:linear-gradient(180deg,#eef4ff,#e3ecff); box-shadow:0 6px 16px rgba(0,0,0,.08) }
.album-btn{ display:inline-flex; align-items:center; gap:.4rem; padding:.4rem .8rem; border:none; border-radius:999px;
  background:linear-gradient(180deg,#f1f6ff,#e5eeff); color:#173c70; font-weight:900; cursor:pointer; box-shadow:0 8px 20px rgba(0,0,0,.1) }

/* יהלום 1–2–1 */
.grid{
  --size: clamp(120px, 22vw, 180px);
  display:grid; gap:16px; margin:10px auto 8px; width:fit-content;
  grid-template-columns: repeat(3, var(--size));
  grid-template-rows: repeat(3, var(--size));
  grid-template-areas: ". a ." "b . c" ". d .";
}
.node{ width:var(--size); height:var(--size) }
.node.a{grid-area:a} .node.b{grid-area:b} .node.c{grid-area:c} .node.d{grid-area:d}
@media (max-width:560px){ .grid{ --size: clamp(110px, 34vw, 160px); gap:12px } }

/* עיגול זכוכית */
.choice{
  position:relative; display:flex; flex-direction:column; align-items:center; justify-content:center;
  width:100%; height:100%; border:none; border-radius:999px; cursor:pointer; text-align:center; padding:12px;
  background: radial-gradient(circle at 35% 30%, rgba(255,255,255,.78), rgba(255,255,255,.52) 70%), var(--grad, rgba(46,107,255,.06));
  -webkit-backdrop-filter: blur(12px) saturate(140%); backdrop-filter: blur(12px) saturate(140%);
  box-shadow: 0 8px 22px rgba(0,0,0,.10); transition: transform .12s ease, box-shadow .2s ease, filter .2s ease;
}
.choice:hover{ filter:saturate(1.12) } .choice:active{ transform:scale(.98) }
.choice .t{ font-weight:900; font-size:1.04rem; color:#173c70 }
.choice .s{ font-size:.9rem; color:#3b5f9a; margin-top:6px }
.choice.selected{ transform:scale(1.04); box-shadow:0 14px 32px rgba(0,0,0,.16), 0 0 0 6px rgba(207,230,255,.55) }
.choice.selected::after{
  content:""; position:absolute; top:6px; inset-inline-end:8px; width:18px; height:18px;
  background: radial-gradient(circle,#fff 0 50%,transparent 60%), linear-gradient(180deg,var(--star2,#fff7de),var(--star,#ffe2a4));
  clip-path: polygon(50% 0%,65% 20%,80% 20%,65% 35%,100% 50%,65% 65%,80% 80%,65% 80%,50% 100%,35% 80%,20% 80%,35% 65%,0% 50%,35% 35%,20% 20%,35% 20%);
  filter: drop-shadow(0 2px 4px rgba(0,0,0,.18)); transform:scale(.7); opacity:0; animation:pop .25s ease forwards;
}
@keyframes pop{ to{transform:scale(1);opacity:1} }

/* טיפוגרפיה זורמת */
.flow{ text-align:center; display:grid; gap:2px }
.flow .l1{ font-weight:900; letter-spacing:.02em; font-size:1.2rem; color:#163a6b }
.flow .l2{ font-weight:800; letter-spacing:.015em; color:#204b82 }
.flow .l3{ font-weight:700; letter-spacing:.01em; color:#2b5c96 }

/* קלף (בחירה+תוכן) */
.parch{
  position:relative; margin:0 auto; width:min(92%,680px);
  background:linear-gradient(180deg,rgba(255,255,255,.85),rgba(255,255,255,.7));
  border-radius:18px; padding:14px; box-shadow:0 12px 28px rgba(0,0,0,.12);
  -webkit-backdrop-filter: blur(10px) saturate(140%); backdrop-filter: blur(10px) saturate(140%);
}

/* טביעת צעד */
.step-illus{
  width:72px; height:72px; margin:0 auto; opacity:.85;
  background:
     radial-gradient(ellipse at 60% 40%, rgba(0,0,0,.12), transparent 60%),
     radial-gradient(ellipse at 45% 70%, rgba(0,0,0,.12), transparent 60%);
  border-radius:30% 50% 40% 50% / 50% 40% 60% 50%;
  transform: rotate(-18deg);
  filter: blur(.2px);
}

/* כוכב פעולה (8 קרניים) */
.star{
  width:200px; height:200px; margin:8px auto;
  background: var(--star-grad, linear-gradient(180deg,#fffaf0,#ffe7b8));
  clip-path: polygon(50% 0%,65% 20%,80% 20%,65% 35%,100% 50%,65% 65%,80% 80%,65% 80%,50% 100%,35% 80%,20% 80%,35% 65%,0% 50%,35% 35%,20% 20%,35% 20%);
  box-shadow:0 14px 30px rgba(0,0,0,.16);
  animation:starIn .45s ease both, floaty 6s ease-in-out infinite;
}
@keyframes starIn{ from{transform:translateY(10px) scale(.94); opacity:0} to{transform:translateY(0) scale(1); opacity:1} }

/* צעדים */
.steps{ list-style:none; padding:0; margin:4px 0 0; text-align:center; line-height:1.7; color:#234c86; font-size:1.03rem; font-weight:700 }

/* CTA */
.cta{ display:block;width:100%;padding:12px 16px;margin-top:10px; background:linear-gradient(180deg,#e6f0ff,#d6e8ff);
  border:none;border-radius:999px;font-size:1rem;font-weight:900;color:var(--text);cursor:pointer;box-shadow:var(--shadow) }

/* אלבום 3D */
.album3d{
  margin:8px auto; width:min(95%,760px); perspective:1000px;
}
.book{
  position:relative; margin:0 auto; width:640px; max-width:90vw; height:260px;
  transform-style:preserve-3d; transform: rotateX(6deg) rotateY(-8deg);
}
.cover, .pages, .back{
  position:absolute; inset:0; border-radius:14px;
}
.cover{
  background:linear-gradient(135deg, rgba(255,255,255,.95), rgba(245,248,255,.85));
  box-shadow:0 30px 60px rgba(0,0,0,.18);
  transform: translateZ(24px);
}
.pages{
  background:repeating-linear-gradient(90deg, #fff 0 4px, #f2f4ff 4px 8px);
  transform: translateZ(12px);
  border-radius:12px;
}
.back{
  background:linear-gradient(135deg, rgba(230,238,255,.9), rgba(255,255,255,.9));
  transform: translateZ(0);
}
/* שמש/כוכב זוהר במרכז האלבום */
.sun{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  width:120px; height:120px;
  background:radial-gradient(circle at 50% 50%, #fff7d6 0 40%, #ffd87a 60%, transparent 62%), var(--star-grad-center, linear-gradient(180deg,#fff2bf,#ffd97a));
  clip-path: polygon(50% 0%,65% 20%,80% 20%,65% 35%,100% 50%,65% 65%,80% 80%,65% 80%,50% 100%,35% 80%,20% 80%,35% 65%,0% 50%,35% 35%,20% 20%,35% 20%);
  filter: drop-shadow(0 18px 28px rgba(0,0,0,.18));
  animation: pulse 3.2s ease-in-out infinite;
}
@keyframes pulse{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.06)}}

/* מודאל (ממוחזר גם לאלבום) */
.overlay{ position:fixed; inset:0; background:rgba(15,34,51,.28); display:none; align-items:center; justify-content:center; z-index:9999 }
.modal{
  position:relative; padding:22px; border-radius:22px; background:rgba(255,255,255,.92);
  -webkit-backdrop-filter: blur(12px) saturate(140%); backdrop-filter: blur(12px) saturate(140%);
  box-shadow:var(--shadow); width:min(92vw,720px); text-align:center; color:#163a6b;
}
.big-star{ width:120px; height:120px; margin:0 auto 10px; background:linear-gradient(180deg,#fffaf0,#ffe7b8);
  clip-path: polygon(50% 0%,65% 20%,80% 20%,65% 35%,100% 50%,65% 65%,80% 80%,65% 80%,50% 100%,35% 80%,20% 80%,35% 65%,0% 50%,35% 35%,20% 20%,35% 20%);
  animation: floaty 6s ease-in-out infinite; filter: drop-shadow(0 8px 22px rgba(0,0,0,.16)) }
.pill{ display:inline-flex; align-items:center; gap:.5rem; padding:.65rem 1.1rem; border-radius:999px;
  background:linear-gradient(180deg,#eef4ff,#dfeaff); color:#163a6b; font-weight:900; box-shadow:var(--shadow); text-decoration:none }
.mini-star{ width:18px;height:18px; background:linear-gradient(180deg,#fffaf0,#ffe7b8); display:inline-block;
  clip-path: polygon(50% 0%,65% 20%,80% 20%,65% 35%,100% 50%,65% 65%,80% 80%,65% 80%,50% 100%,35% 80%,20% 80%,35% 65%,0% 50%,35% 35%,20% 20%,35% 20%);
  filter: drop-shadow(0 2px 6px rgba(0,0,0,.12)) }
</style>
</head>
<body>
  <!-- רקע -->
  <div class="blobs" aria-hidden="true">
    <div class="blob b1"></div><div class="blob b2"></div><div class="blob b3"></div>
  </div>
  <div class="letters" aria-hidden="true">אבגדהוזחט · זרימה · לב פתוח · יחד</div>

  <div class="wrap">
    <main class="card" role="main" aria-labelledby="title">
      <div class="topbar">
        <button class="album-btn" id="openAlbum" title="פתחי אלבום" hidden>📔 אלבום</button>
        <div class="titlebox">
          <h1 id="title">איך בא לך להתחיל?</h1>
          <p class="sub" id="subtitle">בחר/י שלב פתיחה — נקפיץ רעיון קטן שמרגיש נכון עכשיו.</p>
        </div>
        <div style="width:84px"></div>
      </div>

      <div class="status" id="status">
        <span class="chip" id="stepsChip">צעדים: 0</span>
        <span class="chip" id="albumHint">נשמר באלבום ✦</span>
      </div>

      <!-- מסך פתיחה -->
      <section id="screen-home">
        <div class="grid" id="grid">
          <div class="node a"></div>
          <div class="node b"></div>
          <div class="node c"></div>
          <div class="node d"></div>
        </div>
        <div id="hint" class="flow" style="margin-top:6px">
          <div class="l1"></div><div class="l2"></div><div class="l3"></div>
        </div>
        <button class="cta" id="go" disabled>מתגשם</button>
      </section>

      <!-- מסך השראה -->
      <section id="screen-star" hidden></section>

      <!-- מסך סיום + אלבום -->
      <section id="screen-end" hidden></section>
    </main>
  </div>

  <!-- מודאל כללי (בקרוב/אלבום) -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" id="modalBox">
      <div class="big-star" aria-hidden="true"></div>
      <h2 class="title">HeartWays — בקרוב מאוד ✨</h2>
      <p class="text">המשחק המלא בדרך. נשחרר הורדה כשנפתח את השער.</p>
      <a class="pill" id="downloadLink" href="#" data-temp="true"><span class="mini-star"></span>הורדה מוקדמת / עדכון</a>
    </div>
  </div>

<script>
/* מיפוי שלבים + צבעים */
const STAGES = {
  be: { key:'be', title:'להיות', sub:'להאט ולהרגיש את הגוף', accent:'#CCA24A', from:'#FFF1C9', to:'#FFD991',
        acts:["נשימת '4–4' במשך דקה","שחרור כתפיים/לסת","מילה טובה לעצמי"],
        line:n=>`בחרת להיות — שקט קטן עושה פלאים. צעד ${n} נשמר באלבום.` },
  play: { key:'play', title:'לשחק', sub:'קלילות ותנועה', accent:'#2FBF71', from:'#D9FFE7', to:'#A6F4C5',
        acts:["3 תנועות גוף קצרות","חיוך קטן לעצמי","משחקון 60 שניות"],
        line:n=>`בחרת לשחק — תנועה קטנה מזיזה הרים. צעד ${n}.` },
  create:{ key:'create', title:'ליצור', sub:'רעיון + צעד ראשון', accent:'#8B6CF6', from:'#EBDFFF', to:'#CAB7FF',
        acts:["לרשום רעיון אחד","2 דקות צעד ראשון","לשתף חבר/ה לפידבק"],
        line:n=>`בחרת ליצור — התחלה טובה היא חצי דרך. צעד ${n}.` },
  connect:{ key:'connect', title:'להתחבר', sub:'לב אל לב', accent:'#4BA3FF', from:'#E7F2FF', to:'#FFD6E6',
        acts:["הודעת לב קצרה","שיחת 5 דקות","לסגור זמן מפגש"],
        line:n=>`בחרת להתחבר — הודעה קטנה משנה יום. צעד ${n}.` }
};

function vary(hex,amt=.04){ const m=hex.replace('#',''); let r=parseInt(m.substr(0,2),16),g=parseInt(m.substr(2,2),16),b=parseInt(m.substr(4,2),16);
  const delta=((Date.now()%7)-3)*amt; r=Math.max(0,Math.min(255,Math.round(r*(1+delta)))); g=Math.max(0,Math.min(255,Math.round(g*(1+delta)))); b=Math.max(0,Math.min(255,Math.round(b*(1+delta))));
  return '#'+[r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('');
}
function rgba(hex,a){ const m=hex.replace('#',''); const v=parseInt(m,16); return `rgba(${(v>>16)&255},${(v>>8)&255},${v&255},${a})`; }
function setAccent(hex){ document.documentElement.style.setProperty('--accent',hex); document.documentElement.style.setProperty('--star',rgba(hex,.8)); document.documentElement.style.setProperty('--star2',rgba(hex,.45)); }
const $=s=>document.querySelector(s); const $$=s=>Array.from(document.querySelectorAll(s));
const Album={key:'hw_album', load(){try{return JSON.parse(localStorage.getItem(this.key)||'[]')}catch{return[]}}, save(l){try{localStorage.setItem(this.key,JSON.stringify(l))}catch{}}, push(e){const l=this.load(); l.push(e); this.save(l); return l}, count(){return this.load().length}};
function updateStatus(){ $('#stepsChip').textContent = `צעדים: ${Album.count()}`; if(Album.count()>0) $('#openAlbum').hidden=false; }
function setHeader(title,sub){ $('#title').textContent=title; $('#subtitle').textContent=sub; }

/* מסך פתיחה (יהלום) */
function renderHome(){
  const spots={a:$('.node.a'),b:$('.node.b'),c:$('.node.c'),d:$('.node.d')};
  const order=['be','play','create','connect'];
  Object.entries({a:order[0],b:order[1],c:order[2],d:order[3]}).forEach(([pos,key])=>{
    const st=STAGES[key], from=vary(st.from), to=vary(st.to);
    const btn=document.createElement('button'); btn.className='choice'; btn.style.setProperty('--grad',`linear-gradient(180deg,${from},${to})`);
    btn.innerHTML=`<div class="t">${st.title}</div><div class="s">${st.sub}</div>`;
    btn.onclick=()=>selectStage(key,btn);
    spots[pos].innerHTML=''; spots[pos].appendChild(btn);
  });
}
let state={selected:null};
function selectStage(key,el){
  $$('.choice').forEach(b=>b.classList.remove('selected'));
  el.classList.add('selected'); state.selected=key; const st=STAGES[key]; setAccent(st.accent);
  $('#go').disabled=false;
  $('#hint').innerHTML = `<div class="l1">בחרת: ${st.title}</div><div class="l2">קלף קצר ייפתח עם הרעיון שלך</div><div class="l3">הכל נשמר באלבום ✦</div>`;
  setHeader('המשך המסע','הדרך שלך נשמרת — אלבום קסום מתעדכן ✦');
}

/* מסך השראה: קלף + צעד (Footprint) + כוכב פעולה */
function renderStar(){
  const k=state.selected; if(!k) return; const st=STAGES[k]; const n=Album.count()+1;
  const star=$('#screen-star'); $('#screen-home').hidden=true; star.hidden=false;

  const starGrad=`linear-gradient(180deg, ${rgba(st.accent,.95)}, ${rgba(st.accent,.55)})`;
  star.innerHTML=`
    <div class="parch">
      <div class="flow" style="margin:4px 0 8px">
        <div class="l1">קלף ${st.title}</div>
        <div class="l2">${st.line(n)}</div>
        <div class="l3">בחר/י פעולה אחת והתחל/י בקטן</div>
      </div>

      <div class="step-illus" aria-hidden="true"></div>

      <div class="star" style="--star-grad:${starGrad}" aria-hidden="true"></div>

      <ul class="steps">${st.acts.map(a=>`<li>• ${a}</li>`).join('')}</ul>

      <div style="display:grid; gap:10px; grid-template-columns:1fr 1fr; margin-top:8px">
        <button class="cta" id="do">מתגשם</button>
        <button class="cta" id="back" style="background:linear-gradient(180deg,#f7f9ff,#edf3ff)">בחירה אחרת</button>
      </div>
    </div>
  `;

  $('#do').onclick=()=>{
    const entry={ t:Date.now(), key:k, title:st.title, accent:st.accent, line:st.line(n) };
    const list=Album.push(entry); updateStatus(); renderEnd();
  };
  $('#back').onclick=()=>{ star.hidden=true; $('#screen-home').hidden=false; setHeader('איך בא לך להתחיל?','בחר/י שלב פתיחה — נקפיץ רעיון קטן שמרגיש נכון עכשיו.'); };
}

/* מסך סיום + אלבום 3D */
function renderEnd(){
  const k=state.selected, st=STAGES[k]; const end=$('#screen-end'); $('#screen-star').hidden=true; end.hidden=false;
  const sunGrad=`linear-gradient(180deg, ${rgba(st.accent,.95)}, ${rgba(st.accent,.55)})`;
  end.innerHTML=`
    <div class="parch" style="--star-grad:${sunGrad}">
      <div class="flow">
        <div class="l1">יפה! עוד צעד במסע שלך</div>
        <div class="l2">הצעד נשמר באלבום הקסום ✦</div>
        <div class="l3">אפשר להמשיך לבחור — או להציץ באלבום</div>
      </div>

      <div class="album3d" aria-label="אלבום קסום">
        <div class="book">
          <div class="cover"></div>
          <div class="pages"></div>
          <div class="back"></div>
          <div class="sun" style="--star-grad-center:${sunGrad}" aria-hidden="true"></div>
        </div>
      </div>

      <div style="display:grid; gap:10px; grid-template-columns:1fr 1fr; margin-top:6px">
        <button class="cta" id="again">בחירה נוספת</button>
        <button class="cta" id="peekAlbum" style="background:linear-gradient(180deg,#eef6ff,#e2eeff)">📔 פתחי אלבום</button>
      </div>

      <div class="flow" style="margin-top:8px">
        <div class="l1">HeartWays — המשחק המלא מגיע בקרוב 🎮</div>
        <div class="l2">רוצה לקבל גישה מוקדמת כשזה קורה?</div>
        <div><a class="pill" id="downloadLink" href="#" data-temp="true"><span class="mini-star"></span>הורדה מוקדמת / עדכון</a></div>
      </div>
    </div>
  `;
  setAccent(st.accent);
  $('#again').onclick=()=>location.reload();
  $('#peekAlbum').onclick=()=>openAlbum();
  const dl=$('#downloadLink'); dl.addEventListener('click',e=>{ if(dl.dataset.temp==="true"){ e.preventDefault(); openSoon(); }});
  setHeader('המשך המסע','הדרך שלך נשמרת — אלבום קסום מתעדכן ✦');
}

/* אלבום (במודאל) */
function openAlbum(){
  const ov=$('#overlay'), box=$('#modalBox'); ov.style.display='flex'; ov.setAttribute('aria-hidden','false');
  const list=Album.load();
  box.innerHTML=`
    <div class="big-star" aria-hidden="true"></div>
    <h2 class="title">האלבום הקסום שלך ✦</h2>
    <p class="text">הדרך שנשמרה מתוך הבחירות שלך.</p>
    <div id="cards" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:12px;margin-top:8px"></div>
    <button class="cta" id="close">סגור</button>
  `;
  const cards=$('#cards');
  if(!list.length){
    cards.innerHTML=`<div class="parch"><div class="flow"><div class="l2">עדיין ריק</div><div class="l3">כל בחירה נשמרת כאן</div></div></div>`;
  }else{
    list.forEach((e,i)=>{
      const grad=`linear-gradient(180deg, ${rgba(e.accent,.95)}, ${rgba(e.accent,.55)})`;
      const d=new Date(e.t).toLocaleDateString('he-IL',{day:'2-digit',month:'2-digit'});
      const card=document.createElement('div');
      card.className='parch';
      card.innerHTML=`
        <div style="position:absolute;inset-inline-end:10px;top:10px;width:26px;height:26px;background:${grad};
          clip-path:polygon(50% 0%,65% 20%,80% 20%,65% 35%,100% 50%,65% 65%,80% 80%,65% 80%,50% 100%,35% 80%,20% 80%,35% 65%,0% 50%,35% 35%,20% 20%,35% 20%);
          filter:drop-shadow(0 4px 10px rgba(0,0,0,.18))" aria-hidden="true"></div>
        <div class="flow">
          <div class="l1">${e.title} · צעד ${i+1} · ${d}</div>
          <div class="l2">${e.line}</div>
        </div>
      `;
      cards.appendChild(card);
    });
  }
  $('#close').onclick=closeOverlay;
  ov.addEventListener('click',ev=>{ if(ev.target===ov) closeOverlay(); },{once:true});
  document.addEventListener('keydown',function escOnce(ev){ if(ev.key==='Escape'){closeOverlay();document.removeEventListener('keydown',escOnce)}},{once:true});
}
function openSoon(){
  const ov=$('#overlay'), box=$('#modalBox'); ov.style.display='flex'; ov.setAttribute('aria-hidden','false');
  box.innerHTML=`
    <div class="big-star" aria-hidden="true"></div>
    <h2 class="title">HeartWays — בקרוב מאוד ✨</h2>
    <p class="text">המשחק המלא בדרך. נשחרר הורדה כשנפתח את השער.</p>
    <a class="pill" href="#" onclick="return false"><span class="mini-star"></span>הורדה מוקדמת / עדכון</a>
    <button class="cta" id="close">סגור</button>
  `;
  $('#close').onclick=closeOverlay;
}
function closeOverlay(){ const ov=$('#overlay'); ov.style.display='none'; ov.setAttribute('aria-hidden','true'); }

/* Init */
document.addEventListener('DOMContentLoaded', ()=>{
  renderHome(); updateStatus();
  $('#go').onclick=()=>renderStar();
  $('#openAlbum').onclick=()=>openAlbum();
});
</script>
</body>
</html>      position:fixed; inset:0; display:grid; place-items:center; z-index:0; pointer-events:none;
      font-size:18vmin; font-weight:900; letter-spacing:.7vmin; opacity:.06; color:#0f2233;
      text-align:center; line-height:1.1;
      text-shadow:
        0 1px 0 rgba(255,255,255,.12),
        0 8px 16px rgba(15,34,51,.28),
        0 18px 30px rgba(15,34,51,.18);
      filter: blur(.2px);
      user-select:none;
    }

    /* קלף זכוכית נוזלית (ללא מסגרות מרובעות) */
    .card-wrap{ position:relative; z-index:1; width:min(94vw,920px) }
    .card{
      position:relative; background:var(--glass-bg);
      -webkit-backdrop-filter: blur(14px) saturate(140%); backdrop-filter: blur(14px) saturate(140%);
      border-radius:22px; padding:20px; box-shadow:var(--shadow); overflow:hidden;
    }
    .card::after{
      content:""; position:absolute; inset:-40% -60%; border-radius:40%;
      background: conic-gradient(from 0deg, transparent 0 70%, rgba(255,255,255,.18) 80%, transparent 88%);
      animation: sheen 14s linear infinite; mix-blend-mode: soft-light; pointer-events:none;
    }
    @keyframes sheen{ to{ transform: rotate(360deg) } }

    /* כותרת עליונה קבועה */
    .topbar{
      display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px;
    }
    .titles{ text-align:center; flex:1 }
    h1{font-size:1.6rem;margin:0 0 2px;color:var(--text)}
    .sub{margin:0;color:var(--text-soft);font-weight:700}

    /* מידע דינמי (מונה צעדים + רמז אלבום) */
    .status{
      display:flex; align-items:center; gap:.45rem; flex-wrap:wrap; justify-content:center;
      color:#1c3f74; font-weight:800; margin:8px 0 2px;
    }
    .chip{
      display:inline-flex; align-items:center; gap:.35rem; padding:.35rem .65rem; border-radius:999px;
      background:linear-gradient(180deg,#eef4ff,#e3ecff); box-shadow:0 6px 16px rgba(0,0,0,.08);
    }
    .album-btn{
      display:inline-flex; align-items:center; gap:.4rem; padding:.4rem .8rem; border:none; border-radius:999px;
      background:linear-gradient(180deg,#f1f6ff,#e5eeff); color:#173c70; font-weight:900; cursor:pointer;
      box-shadow:0 8px 20px rgba(0,0,0,.1);
    }

    /* גריד יהלום (1–2–1) לעיגולים */
    .stage-grid{
      --size: clamp(120px, 22vw, 190px);
      display:grid; gap:16px; margin:10px auto 6px; width:fit-content;
      grid-template-columns: repeat(3, var(--size));
      grid-template-rows: repeat(3, var(--size));
      grid-template-areas:
        ". a ."
        "b . c"
        ". d .";
    }
    .node{ width:var(--size); height:var(--size); }
    .node.a{ grid-area:a } .node.b{ grid-area:b } .node.c{ grid-area:c } .node.d{ grid-area:d }

    @media (max-width:560px){
      .stage-grid{ --size: clamp(110px, 34vw, 160px); gap:12px }
    }

    /* עיגולים — ללא מסגרות מרובעות */
    .stage-btn{
      position:relative; display:flex; flex-direction:column; align-items:center; justify-content:center;
      width:100%; height:100%;
      border-radius:999px; border:none; cursor:pointer;
      background: radial-gradient(circle at 35% 30%, rgba(255,255,255,.78), rgba(255,255,255,.52) 70%),
                  var(--stage-grad, rgba(46,107,255,.06));
      -webkit-backdrop-filter: blur(12px) saturate(140%); backdrop-filter: blur(12px) saturate(140%);
      box-shadow: 0 8px 22px rgba(0,0,0,.10);
      transition: transform .12s ease, box-shadow .2s ease, filter .2s ease;
      text-align:center; padding:12px;
    }
    .stage-btn .title{ font-weight:900; font-size:1.05rem; color:#173c70 }
    .stage-btn .sub{ font-size:.9rem; color:#3b5f9a; margin-top:6px }
    .stage-btn:hover{ filter: saturate(1.12) }
    .stage-btn:active{ transform: scale(.98) }
    .stage-btn.selected{
      transform: scale(1.04);
      box-shadow: 0 14px 32px rgba(0,0,0,.16), 0 0 0 6px rgba(207,230,255,.55);
    }
    /* כוכב 8 קרניים קטן לסימון בחירה */
    .stage-btn.selected::after{
      content:""; position:absolute; top:6px; inset-inline-end:8px; width:18px; height:18px;
      background: radial-gradient(circle, #fff 0 50%, transparent 60%), var(--star-grad);
      clip-path: polygon(50% 0%, 65% 20%, 80% 20%, 65% 35%, 100% 50%, 65% 65%, 80% 80%, 65% 80%,
                         50% 100%, 35% 80%, 20% 80%, 35% 65%, 0% 50%, 35% 35%, 20% 20%, 35% 20%);
      filter: drop-shadow(0 2px 4px rgba(0,0,0,.18));
      transform: scale(.7); opacity:0; animation: star-pop .25s ease forwards;
    }
    @keyframes star-pop{ to{ transform: scale(1); opacity:1 } }

    .hint{ margin:6px 0 0; text-align:center; color:#1e3f77; font-weight:800 }

    /* כפתור פעולה */
    .cta{
      display:block; width:100%; padding:12px 16px; margin-top:10px;
      background:linear-gradient(180deg,#e6f0ff,#d6e8ff); border:none; border-radius:999px;
      font-size:1rem; font-weight:900; color:var(--text); cursor:pointer; box-shadow:var(--shadow);
    }

    /* כוכב השראה — 8 קרניים, גדול ותנועה עדינה */
    .star-card{ position:relative; display:grid; gap:12px }
    .star{
      position:relative; width:180px; height:180px; margin:0 auto;
      background: var(--star-grad);
      clip-path: polygon(50% 0%, 65% 20%, 80% 20%, 65% 35%, 100% 50%, 65% 65%, 80% 80%, 65% 80%,
                         50% 100%, 35% 80%, 20% 80%, 35% 65%, 0% 50%, 35% 35%, 20% 20%, 35% 20%);
      box-shadow:0 14px 30px rgba(0,0,0,.16);
      animation: starIn .45s ease both, float-rot 6s ease-in-out infinite;
    }
    @keyframes starIn{ from{transform:translateY(10px) scale(.94); opacity:0} to{transform:translateY(0) scale(1); opacity:1} }
    @keyframes float-rot{ 0%,100%{ transform: translateY(0) rotate(0deg) } 50%{ transform: translateY(-8px) rotate(3deg) } }

    /* שורות זורמות בטיפוגרפיה משתנה */
    .flow{ text-align:center; display:grid; gap:2px; }
    .flow .l1{ font-weight:900; letter-spacing:.02em; font-size:1.2rem; color:#163a6b }
    .flow .l2{ font-weight:800; letter-spacing:.015em; color:#204b82 }
    .flow .l3{ font-weight:700; letter-spacing:.01em; color:#2b5c96 }

    .steps{ list-style:none; padding:0; margin:2px 0 0; text-align:center; line-height:1.7; color:#234c86; font-size:1.03rem; font-weight:700 }

    /* סיום — דלת נפתחת + “בקרוב” */
    .door-wrap{ display:flex; flex-direction:column; gap:12px }
    .door{
      position:relative; width:100%; height:260px; overflow:hidden; border-radius:16px; background:var(--door-grad);
      -webkit-backdrop-filter: blur(6px) saturate(140%); backdrop-filter: blur(6px) saturate(140%);
    }
    .panel{ position:absolute; top:0; width:50%; height:100%; background:inherit; transition: transform 1.1s ease }
    .panel.left{ left:0; transform-origin:left } .panel.right{ right:0; transform-origin:right }
    body.done .panel.left{ transform: translateX(-100%) } body.done .panel.right{ transform: translateX(100%) }
    .end-msg{ position:absolute; z-index:2; inset:0; display:grid; place-items:center; text-align:center; color:#fff; text-shadow:0 2px 12px rgba(0,0,0,.22); padding:0 12px }
    .idea-star{
      position:absolute; width:100px; height:100px; left:10%; top:12%;
      background: var(--star-grad);
      clip-path: polygon(50% 0%, 65% 20%, 80% 20%, 65% 35%, 100% 50%, 65% 65%, 80% 80%, 65% 80%,
                         50% 100%, 35% 80%, 20% 80%, 35% 65%, 0% 50%, 35% 35%, 20% 20%, 35% 20%);
      opacity:.9; filter: drop-shadow(0 8px 18px rgba(0,0,0,.18)); animation: floaty 6s ease-in-out infinite;
    }

    /* הודעת "בקרוב" + כפתור הורדה */
    .launch{ margin-top:8px; text-align:center; color:#1d3f75; }
    .pill{
      display:inline-flex; align-items:center; gap:.5rem; padding:.65rem 1.1rem; border-radius:999px;
      background:linear-gradient(180deg,#eef4ff,#dfeaff); color:#163a6b; font-weight:900; box-shadow:var(--shadow);
      text-decoration:none;
    }
    .pill .mini-star{
      width:18px; height:18px; background:var(--star-grad); display:inline-block;
      clip-path: polygon(50% 0%, 65% 20%, 80% 20%, 65% 35%, 100% 50%, 65% 65%, 80% 80%, 65% 80%,
                         50% 100%, 35% 80%, 20% 80%, 35% 65%, 0% 50%, 35% 35%, 20% 20%, 35% 20%);
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.12));
    }

    /* מודאל "בקרוב" */
    .overlay{ position:fixed; inset:0; background:rgba(15,34,51,.28); display:none; align-items:center; justify-content:center; z-index:9999; }
    .modal{
      position:relative; padding:22px; border-radius:22px; background:rgba(255,255,255,.9);
      -webkit-backdrop-filter: blur(12px) saturate(140%); backdrop-filter: blur(12px) saturate(140%);
      box-shadow:var(--shadow); width:min(92vw,520px);
      text-align:center; color:#163a6b;
    }
    .modal .big-star{
      width:120px; height:120px; margin:0 auto 10px; background:var(--star-grad);
      clip-path: polygon(50% 0%, 65% 20%, 80% 20%, 65% 35%, 100% 50%, 65% 65%, 80% 80%, 65% 80%,
                         50% 100%, 35% 80%, 20% 80%, 35% 65%, 0% 50%, 35% 35%, 20% 20%, 35% 20%);
      animation: float-rot 6s ease-in-out infinite; filter: drop-shadow(0 8px 22px rgba(0,0,0,.16));
    }
    .modal .title{ font-weight:900; font-size:1.25rem; margin:0 0 6px }
    .modal .text{ color:#2a4e8a; font-weight:700; margin:0 0 10px }
    .modal .close{ margin-top:8px }

    /* אלבום קסום */
    .album-grid{
      display:grid; grid-template-columns: repeat(auto-fill, minmax(220px,1fr));
      gap:12px; margin-top:8px;
    }
    .album-card{
      position:relative; padding:14px; border-radius:18px;
      background:rgba(255,255,255,.75); -webkit-backdrop-filter: blur(10px) saturate(140%); backdrop-filter: blur(10px) saturate(140%);
      box-shadow:0 10px 26px rgba(0,0,0,.12);
    }
    .album-card .tag{ font-size:.8rem; font-weight:900; color:#163a6b; opacity:.8 }
    .album-card .title{ font-weight:900; color:#163a6b; margin:4px 0 }
    .album-card .line{ color:#244f8a; font-weight:800 }
    .album-card .star-mini{
      position:absolute; width:28px; height:28px; top:10px; inset-inline-end:10px; background:var(--star-grad);
      clip-path: polygon(50% 0%, 65% 20%, 80% 20%, 65% 35%, 100% 50%, 65% 65%, 80% 80%, 65% 80%,
                         50% 100%, 35% 80%, 20% 80%, 35% 65%, 0% 50%, 35% 35%, 20% 20%, 35% 20%);
      filter: drop-shadow(0 4px 10px rgba(0,0,0,.18));
    }
  </style>
</head>
<body>
  <!-- רקע -->
  <div class="blobs" aria-hidden="true">
    <div class="blob b1"></div><div class="blob b2"></div><div class="blob b3"></div>
  </div>
  <div class="letters" aria-hidden="true">אבגדהוזחט יכ ל ם נ ס ע — זרימה · לב פתוח · יחד</div>

  <div class="card-wrap">
    <main class="card" role="main" aria-labelledby="title">
      <!-- טופ-בר קבוע -->
      <div class="topbar">
        <button class="album-btn" id="openAlbum" title="פתחי אלבום" hidden>📔 אלבום</button>
        <div class="titles">
          <h1 id="title">איך בא לך להתחיל?</h1>
          <p class="sub" id="subtitle">בחר/י שלב פתיחה — נקפיץ רעיון קטן שמרגיש נכון עכשיו.</p>
        </div>
        <div style="width:80px"></div>
      </div>

      <!-- סטטוס דינמי -->
      <div class="status" id="status">
        <span class="chip" id="stepsChip">צעדים: 0</span>
        <span class="chip" id="albumHint">נשמר באלבום ✦</span>
      </div>

      <!-- מסך פתיחה -->
      <section id="stage-screen">
        <div class="stage-grid" id="grid">
          <div class="node a"></div>
          <div class="node b"></div>
          <div class="node c"></div>
          <div class="node d"></div>
        </div>
        <div id="selection-hint" class="hint" aria-live="polite"></div>
        <button class="cta" id="go" disabled>מתגשם</button>
      </section>

      <!-- כוכב השראה -->
      <section id="star-screen" hidden></section>

      <!-- סיום + “בקרוב” -->
      <section id="end-screen" hidden></section>

      <div class="footer">© <span id="year"></span> HeartWays</div>
    </main>
  </div>

  <!-- מודאל "בקרוב" לכפתור הורדה זמני -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-labelledby="soon-title" aria-hidden="true">
    <div class="modal">
      <div class="big-star" aria-hidden="true"></div>
      <h2 id="soon-title" class="title">HeartWays — בקרוב מאוד ✨</h2>
      <p class="text">המשחק המלא בדרך. נשחרר הורדה כשנפתח את השער.</p>
      <button class="cta close" id="closeModal">סגור</button>
    </div>
  </div>

  <script>
    /* שלבים + גוונים */
    const STAGES = {
      be:      { key:'be', title:"להיות",   sub:"להאט רגע ולהתחבר לגוף",  accent:"#CCA24A",
                 gradFrom:"#FFF1C9", gradTo:"#FFD991",
                 actions:["נשימת '4–4' במשך דקה","בדיקת כתפיים/לסת – לשחרר","מילה טובה לעצמי היום"],
                 summary:(n)=>`בחרת להיות. רגע של נשימה ושחרור — צעד ${n} במסע שלך.` },
      play:    { key:'play', title:"לשחק",  sub:"קצת קלילות ותנועה",       accent:"#2FBF71",
                 gradFrom:"#D9FFE7", gradTo:"#A6F4C5",
                 actions:["3 תנועות גוף קצרות","חיוך קטן לעצמי","משחקון 60 שניות עם מה שיש"],
                 summary:(n)=>`בחרת לשחק. טיפונת קלילות מזיזה הרים — צעד ${n} נשמר באלבום.` },
      create:  { key:'create', title:"ליצור", sub:"רעיון קטן + צעד ראשון", accent:"#8B6CF6",
                 gradFrom:"#EBDFFF", gradTo:"#CAB7FF",
                 actions:["לרשום רעיון אחד","להקדיש 2 דקות לצעד ראשון","לשתף חבר/ה לפידבק"],
                 summary:(n)=>`בחרת ליצור. רעיון אחד ועוד צעד, ויש התחלה — צעד ${n}.` },
      connect: { key:'connect', title:"להתחבר", sub:"לב אל לב, הודעה קצרה", accent:"#4BA3FF",
                 gradFrom:"#E7F2FF", gradTo:"#FFD6E6",
                 actions:["לשלוח הודעת לב קצרה למישהו","להציע שיחת 5 דקות","לסגור זמן מפגש השבוע"],
                 summary:(n)=>`בחרת להתחבר. הודעה קטנה — שינוי גדול. צעד ${n} נוסיף לאלבום.` }
    };

    /* seed לוריאציה עדינה */
    function getSeed(){
      try{
        let s = localStorage.getItem('hw_seed');
        if(!s){
          s = String((Date.now() ^ (navigator.hardwareConcurrency||4) ^ (screen.width*screen.height))>>>0);
          localStorage.setItem('hw_seed', s);
        }
        return parseInt(s.slice(-6),10) || 1;
      }catch{ return 1; }
    }
    const SEED = getSeed();

    const prefersReduce = matchMedia?.('(prefers-reduced-motion: reduce)').matches || false;
    function vibrate(ms=12){ if(!prefersReduce && navigator.vibrate) navigator.vibrate(ms); }
    function hexToRGBA(hex, a){
      const m = hex.replace('#',''); const b = parseInt(m.length===3 ? m.split('').map(c=>c+c).join('') : m, 16);
      return `rgba(${(b>>16)&255},${(b>>8)&255},${b&255},${a})`;
    }
    function vary(hex, amt=0.04){
      const m = hex.replace('#','');
      let r=parseInt(m.substr(0,2),16), g=parseInt(m.substr(2,2),16), b=parseInt(m.substr(4,2),16);
      const delta = (((SEED%7)-3)*amt);
      r = Math.max(0, Math.min(255, Math.round(r*(1+delta))));
      g = Math.max(0, Math.min(255, Math.round(g*(1+delta))));
      b = Math.max(0, Math.min(255, Math.round(b*(1+delta))));
      return '#'+[r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('');
    }

    /* אלבום ב-localStorage */
    const Album = {
      key:'hw_album',
      load(){ try{ return JSON.parse(localStorage.getItem(this.key)||'[]'); } catch{ return []; } },
      save(list){ try{ localStorage.setItem(this.key, JSON.stringify(list)); } catch{} },
      push(entry){ const list=this.load(); list.push(entry); this.save(list); return list; },
      count(){ return this.load().length; }
    };

    /* UI helpers */
    const $ = (s,root=document)=>root.querySelector(s);
    const $$ = (s,root=document)=>Array.from(root.querySelectorAll(s));
    function setAccent(hex){ document.documentElement.style.setProperty('--accent', hex); }
    function updateStatus(){
      $('#stepsChip').textContent = `צעדים: ${Album.count()}`;
      $('#albumHint').textContent = 'נשמר באלבום ✦';
      // הצג כפתור אלבום כשיש לפחות רשומה אחת
      if (Album.count()>0) $('#openAlbum').hidden = false;
    }
    function setSubtitle(msg){ $('#subtitle').textContent = msg; }

    /* מסך פתיחה */
    const order = ['be','play','create','connect']; // סדר בסיס ליהלום
    function renderStages(){
      const nodes = { a:$('.node.a'), b:$('.node.b'), c:$('.node.c'), d:$('.node.d') };
      const map = { a:order[0], b:order[1], c:order[2], d:order[3] };
      Object.entries(map).forEach(([spot,key])=>{
        const st = STAGES[key];
        const from = vary(st.gradFrom), to = vary(st.gradTo);
        const btn = document.createElement('button');
        btn.className = 'stage-btn';
        btn.style.setProperty('--stage-grad', `linear-gradient(180deg, ${from}, ${to})`);
        btn.innerHTML = `<div class="title">${st.title}</div><div class="sub">${st.sub}</div>`;
        btn.onclick = ()=>onSelectStage(key, btn);
        nodes[spot].innerHTML = ''; nodes[spot].appendChild(btn);
      });
    }

    let state = { selected:null };
    function onSelectStage(key, el){
      vibrate(14);
      $$('.stage-btn').forEach(b=>b.classList.remove('selected'));
      el.classList.add('selected');
      state.selected = key;
      setAccent(STAGES[key].accent);
      $('#selection-hint').textContent = `בחרת: ${STAGES[key].title} — בואי נקפיץ רעיון קטן שמתאים עכשיו.`;
      $('#go').disabled = false;
      // במעבר למסך הבא — עדכן כותרת/סטטוס
      setSubtitle('הדרך שלך נשמרת — אלבום קסום מתעדכן ✦');
      $('#title').textContent = 'המשך המסע';
      updateStatus();
    }

    /* כוכב השראה */
    function renderStar(){
      const key = state.selected; if(!key) return;
      const st = STAGES[key];
      const num = Album.count()+1;
      const starScreen = $('#star-screen');
      starScreen.hidden = false; $('#stage-screen').hidden = true;

      // משפט מסכם (ייכנס לאלבום)
      const summaryLine = st.summary(num);

      starScreen.innerHTML = `
        <div class="star-card">
          <div class="star" aria-hidden="true"></div>
          <div class="flow">
            <div class="l1">רעיון קטן ל${st.title} — עכשיו</div>
            <div class="l2">${summaryLine}</div>
            <div class="l3">בחרי פעולה אחת ובצעי אותה היום ✦</div>
          </div>
          <ul class="steps">${st.actions.map(a=>`<li>• ${a}</li>`).join('')}</ul>
          <div style="display:grid; gap:10px; grid-template-columns: 1fr 1fr; margin-top:6px">
            <button class="cta" id="do">מתגשם</button>
            <button class="cta" id="back" style="background:linear-gradient(180deg,#f7f9ff,#edf3ff)">בחירה אחרת</button>
          </div>
        </div>
      `;

      $('#do').onclick = ()=>{
        vibrate();
        // שמירה לאלבום
        const entry = {
          t: Date.now(),
          key: st.key,
          title: st.title,
          accent: st.accent,
          line: summaryLine
        };
        const list = Album.push(entry);
        updateStatus();
        // אחרי 4 צעדים — הציעי לראות אלבום
        if (list.length>=4) $('#openAlbum').hidden = false;
        renderEnd();
      };

      $('#back').onclick = ()=>{
        vibrate();
        starScreen.hidden = true; $('#stage-screen').hidden = false;
        setSubtitle('בחר/י שלב פתיחה — נקפיץ רעיון קטן שמרגיש נכון עכשיו.');
        $('#title').textContent = 'איך בא לך להתחיל?';
      };
    }

    /* סיום */
    function renderEnd(){
      const key = state.selected; const st = STAGES[key];
      const end = $('#end-screen');
      end.hidden = false; $('#star-screen').hidden = true;

      end.innerHTML = `
        <div class="door-wrap">
          <div class="door" style="--door-grad:linear-gradient(180deg, ${st.accent}, ${hexToRGBA(st.accent, .2)})">
            <div class="panel left"></div><div class="panel right"></div>
            <div class="idea-star" aria-hidden="true"></div>
            <div class="end-msg">
              <div>
                <div style="font-size:1.15rem;margin-bottom:.25rem">יפה! עוד צעד במסע שלך.</div>
                <div style="font-size:1.5rem;font-weight:800;margin-bottom:.35rem">${st.title}</div>
                <div>הצעד נשמר באלבום הקסום ✦</div>
              </div>
            </div>
          </div>

          <div class="status">
            <button class="album-btn" id="peekAlbum">📔 פתחי אלבום</button>
            <button class="cta" id="again">בחירה נוספת</button>
          </div>

          <div class="launch">
            <p style="margin:.6rem 0 .4rem; font-weight:900; font-size:1.15rem;">HeartWays — המשחק המלא מגיע בקרוב 🎮</p>
            <p style="margin:.2rem 0 .8rem; color:#2a4e8a; font-weight:700;">רוצה לקבל גישה מוקדמת כשזה קורה?</p>
            <a class="pill" id="downloadLink" href="#" data-temp="true">
              <span class="mini-star" aria-hidden="true"></span>
              הורדה מוקדמת / עדכון
            </a>
          </div>
        </div>
      `;

      document.body.classList.add('done');
      $('#again').onclick = ()=>{ vibrate(); location.reload(); };
      $('#peekAlbum').onclick = ()=>{ vibrate(); openAlbum(); };

      // כפתור זמני → מודאל
      const dl = $('#downloadLink');
      dl.addEventListener('click', (e)=>{
        if(dl.dataset.temp === "true"){ e.preventDefault(); openSoonModal(); }
      });

      // עדכון כותרת/סטטוס
      setSubtitle('הדרך שלך נשמרת — אלבום קסום מתעדכן ✦');
      updateStatus();
    }

    /* אלבום: מציג מודאל עם כרטיסים */
    function openAlbum(){
      // בונים מודאל אלבום דינמי (שימוש במודאל "בקרוב" כמסגרת)
      const ov = $('#overlay'); ov.style.display='flex'; ov.setAttribute('aria-hidden','false');
      const box = ov.querySelector('.modal');
      box.innerHTML = `
        <div class="big-star" aria-hidden="true"></div>
        <h2 class="title">האלבום הקסום שלך ✦</h2>
        <p class="text">הדרך שנשמרה מתוך הבחירות שלך.</p>
        <div class="album-grid" id="albumGrid"></div>
        <button class="cta close" id="closeModal">סגור</button>
      `;
      const grid = $('#albumGrid', box);
      const list = Album.load();
      if (!list.length){
        grid.innerHTML = `<div class="album-card"><div class="title">עדיין ריק</div><div class="line">כל בחירה נשמרת כאן.</div></div>`;
      }else{
        list.forEach((e,i)=>{
          const card = document.createElement('div');
          card.className='album-card';
          card.style.setProperty('--star-grad', `linear-gradient(180deg, ${hexToRGBA(e.accent,.95)}, ${hexToRGBA(e.accent,.55)})`);
          const d = new Date(e.t);
          const date = d.toLocaleDateString('he-IL',{day:'2-digit',month:'2-digit'});
          card.innerHTML = `
            <div class="star-mini" aria-hidden="true"></div>
            <div class="tag">${date} · צעד ${i+1}</div>
            <div class="title">${e.title}</div>
            <div class="line">${e.line}</div>
          `;
          grid.appendChild(card);
        });
      }
      $('#closeModal', box).onclick = closeSoonModal;
      ov.addEventListener('click', (e)=>{ if(e.target===ov) closeSoonModal(); }, { once:true });
      document.addEventListener('keydown', function escOnce(ev){ if(ev.key==='Escape'){ closeSoonModal(); document.removeEventListener('keydown', escOnce); } }, { once:true });
    }

    /* מודאל "בקרוב" (ממחזר גם לאלבום) */
    function openSoonModal(){
      const ov = $('#overlay'); ov.style.display='flex'; ov.setAttribute('aria-hidden','false');
      $('#closeModal').onclick = closeSoonModal;
      ov.addEventListener('click', (e)=>{ if(e.target===ov) closeSoonModal(); }, { once:true });
      document.addEventListener('keydown', function escOnce(ev){ if(ev.key==='Escape'){ closeSoonModal(); document.removeEventListener('keydown', escOnce); } }, { once:true });
    }
    function closeSoonModal(){
      const ov = $('#overlay');
      ov.style.display='none'; ov.setAttribute('aria-hidden','true');
    }

    /* Init */
    document.addEventListener('DOMContentLoaded', ()=>{
      $('#year').textContent = String(new Date().getFullYear());
      renderStages();
      updateStatus();
      $('#go').onclick = ()=>{ if(state.selected){ vibrate(); renderStar(); } };
      $('#openAlbum').onclick = ()=>{ vibrate(); openAlbum(); };
    });
  </script>
</body>
</html>
